"use strict";!function(t){var e="scrollSpy",i="plugin_"+e,n=function(i,n){var r=this;r.element=i,r.attributes=["offset","sections"],r.defaults={debug:!1,selectors:["section","[data-nav-item]"],navID:e.toLowerCase(),parent:"body",baseClass:e.toLowerCase(),currentClass:"current",delta:0,dataNavAttr:"nav",eventSuffix:"."+e+"-plugin",hideOnMobile:!0,itemDataAttr:"nav-item",mobileMaxWidth:990,navSectionClassPrefix:"nav-section--",scrollDuration:500,sections:[],timer:void 0,timerDelay:100},r.timer=void 0,r.winWidth=void 0,r.winHeight=void 0,r.$win=t(window),r.init(n)};n.prototype={_log:function(t){if(this.settings.debug===!0){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];console.log("["+e+":"+t+"]",n)}},_setCurrent:function(){this._log("_setCurrent");var e=this,i=e.settings,n=Math.round(t(window).scrollTop()-e.winHeight/100*50),r=void 0;e.$items.removeClass(i.currentClass);var a=!0,o=!1,s=void 0;try{for(var l,c=i.sections[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)if(r=l.value,n<r.offset)return r.$nav.addClass(i.currentClass),!1}catch(t){o=!0,s=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw s}}return!0},update:function(){this._log("update");var t=this,e=t.settings;t.winHeight=Math.ceil(t.$win.height()),t.winWidth=Math.floor(t.$win.width());var i=!0,n=!1,r=void 0;try{for(var a,o=e.sections[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var s=a.value;s.offset=Math.floor(s.$el.offset().top)}}catch(t){n=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw r}}t.$nav.toggle(e.hideOnMobile&&t.winWidth>e.mobileMaxWidth),t._setCurrent(),t.$element.trigger("update")},_collectSections:function(){this._log("_collectSections");var e=this,i=e.settings,n=[];t(i.selectors.join(", ")).each(function(e,r){var a=t(r),o={$el:a,title:void 0,$nav:void 0},s=a.data(i.itemDataAttr);o.title=s?s:a.find(".titlebar h3").text(),void 0!==o.title&&s!==!1&&(a.addClass(i.navSectionClassPrefix+o.title.toLowerCase().replace(" ","-")),o.title&&n.push(o))}),i.sections=n},_scrollToSection:function(e){this._log("_scrollToSection");var i=this.settings,n=Math.floor(e.$el.offset().top),r=n-i.delta-parseInt(e.$el.css("margin-top"),10);e.offset=n,t("html, body").animate({scrollTop:r},i.scrollDuration,"swing")},_setListener:function(){this._log("_setListener");var i=this,n=i.settings,r=t(window);i.$items.on("click."+e,function(e){e.preventDefault(),i._scrollToSection(t(e.currentTarget).data(n.itemDataAttr))}),r.on("scroll."+e,function(){(!n.hideOnMobile||i.winWidth>n.mobileMaxWidth)&&i._setCurrent()}),r.on("resize."+e,function(){clearTimeout(i.timer),i.timer=setTimeout(i.update,n.timerDelay)})},_createMarkup:function(){this._log("_createMarkup");var e=this,i=e.settings;e.$nav=t("<nav>",{id:i.navID,class:i.baseClass+"--wrap"}),e.$list=t('<ul class="'+i.baseClass+'--list" />').appendTo(e.$nav),e.$items=t();var n=!0,r=!1,a=void 0;try{for(var o,s=i.sections[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;l.$nav=t('<li class="'+i.baseClass+'--list-item"><span>'+l.title+"</span></li>").data(i.itemDataAttr,l).appendTo(e.$list),e.$items=e.$items.add(l.$nav)}}catch(t){r=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}e.$nav.appendTo(t(i.parent))},create:function(){this._log("create");var t=this;t._collectSections(),t._createMarkup(),t._setListener(),t.$element.trigger("create")},_importAttrConfig:function(){this._log("_importAttrConfig");var t=this,e=t.settings,i=t.$element.data(),n=!0,r=!1,a=void 0;try{for(var o,s=t.attributes[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;if(i.hasOwnProperty(l))switch(l){case"center":e[l]={lat:i[l][0],lng:i[l][1]};break;default:e[l]=i[l]}}}catch(t){r=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return t.settings},_init:function(e){var i=this,n=t.extend(i.defaults,e);i.$element=t(i.element),i.settings=n,i._importAttrConfig(),i.create(),i.update(),i.$element.trigger("init")}},t.fn[e]=function(e,r){return this.each(function(){var a=this;t.data(a,i)?n.prototype[e]&&"string"==typeof e&&"_"!==e.substr(0,1)&&t.data(a,i)[e](r):t.data(a,i,new n(a,e))})}}(jQuery);