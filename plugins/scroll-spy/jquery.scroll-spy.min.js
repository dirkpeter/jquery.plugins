"use strict";!function(t,e){var i="scrollSpy",n="plugin_"+i,s=function(t,e){this.element=t,this.attributes=["offset","sections"],this.timer=void 0,this.winWidth=void 0,this.winHeight=void 0,this.defaults={debug:!1,delta:0,navID:i.toLowerCase(),baseClass:i.toLowerCase(),dataNavAttr:"nav",itemDataAttr:"nav-item",navSectionClassPrefix:"nav-section--",currentClass:"current",selectors:["section","[data-nav-item]"],$parent:"body",timerDelay:100,timer:void 0,scrollDuration:500,hideOnMobile:!0,mobileMaxWidth:990,sections:[]},this.init(e)};s.prototype={_log:function(t){this.settings.debug===!0&&console.log("["+i+"]",t)},_setCurrent:function(){this._log("_setCurrent");var e=this,i=e.settings,n=Math.round(t(window).scrollTop()-e.winHeight/100*50);e.$items.removeClass(i.currentClass);var s=!0,a=!1,r=void 0;try{for(var o,l=i.sections[Symbol.iterator]();!(s=(o=l.next()).done);s=!0){var c=o.value;if(n<c.offset)return c.$nav.addClass(i.currentClass),!1}}catch(t){a=!0,r=t}finally{try{!s&&l.return&&l.return()}finally{if(a)throw r}}},update:function(){this._log("update");var e=this,i=e.settings,n=t(window);e.winHeight=Math.ceil(n.height()),e.winWidth=Math.floor(n.width());var s=!0,a=!1,r=void 0;try{for(var o,l=i.sections[Symbol.iterator]();!(s=(o=l.next()).done);s=!0){var c=o.value;c.offset=Math.floor(c.$el.offset().top)}}catch(t){a=!0,r=t}finally{try{!s&&l.return&&l.return()}finally{if(a)throw r}}e.$nav.toggle(i.hideOnMobile&&e.winWidth>i.mobileMaxWidth),e._setCurrent(),e.$element.trigger("update")},_collectSections:function(){this._log("_collectSections");var e=this,i=e.settings,n=[];t(i.selectors.join(", ")).each(function(){var e=t(this),s={$el:e,title:void 0,$nav:void 0},a=e.data(i.itemDataAttr);s.title=a?a:e.find(".titlebar h3").text(),void 0!==s.title&&a!==!1&&(e.addClass(i.navSectionClassPrefix+s.title.toLowerCase().replace(" ","-")),s.title&&n.push(s))}),i.sections=n},_scrollToSection:function(e){this._log("_scrollToSection");var i=this.settings,n=Math.floor(e.$el.offset().top),s=n-i.delta-parseInt(e.$el.css("margin-top"),10);e.offset=n,t("html, body").animate({scrollTop:s},i.scrollDuration,"swing")},_setListener:function(){this._log("_setListener");var e=this,n=e.settings,s=t(window);e.$items.on("click."+i,function(i){i.preventDefault(),e._scrollToSection(t(this).data(n.itemDataAttr))}),s.on("scroll."+i,function(){(!n.hideOnMobile||e.winWidth>n.mobileMaxWidth)&&e._setCurrent()}),s.on("resize."+i,function(){clearTimeout(e.timer),e.timer=setTimeout(function(){e.update()},n.timerDelay)})},_createMarkup:function(){this._log("_createMarkup");var e=this,i=e.settings;e.$nav=t("<nav>",{id:i.navID,class:i.baseClass+"--wrap"}),e.$list=t('<ul class="'+i.baseClass+'--list" />').appendTo(e.$nav),e.$items=t();var n=!0,s=!1,a=void 0;try{for(var r,o=i.sections[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var l=r.value;l.$nav=t('<li class="'+i.baseClass+'--list-item"><span>'+l.title+"</span></li>").data(i.itemDataAttr,l).appendTo(e.$list),e.$items=e.$items.add(l.$nav)}}catch(t){s=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}e.$nav.appendTo(t(i.$parent))},create:function(){this._log("create");var t=this;t._collectSections(),t._createMarkup(),t._setListener(),t.$element.trigger("create")},_importAttrConfig:function(){var t,e=this,i=e.settings,n=e.$element.data("options");if(!n)return!1;for(var s=0,a=e.attributes.length;s<a;s+=1)t=e.attributes[s],n.hasOwnProperty(t)&&(i[t]=n[t])},init:function(e){var i=this;i.$element=t(i.element),i.settings=t.extend(i.defaults,e),i._importAttrConfig(),i.create(),i.update(),i.$element.trigger("init")}},t.fn[i]=function(e,i){return this.each(function(){t.data(this,n)?s.prototype[e]&&"string"==typeof e&&"_"!==e.substr(0,1)&&t.data(this,n)[e](i):t.data(this,n,new s(this,e))})}}(jQuery);